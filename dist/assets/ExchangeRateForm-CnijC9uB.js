import{r as s,y as ya,b as u,j as a}from"./index-CZLZpOaH.js";import{M as K}from"./ModalComponent-Can9sfzz.js";import{M as Q}from"./ModalComponentPopup-D_u4dGYC.js";import{C as l}from"./common.constants-BAKO8LyS.js";import{C as S}from"./Container-D9at3elR.js";import{F as o}from"./Form-ExWjSL5Y.js";import{R as x}from"./Row-q1SNRrbp.js";import{C as h}from"./Col-BflThe67.js";import{A as V}from"./Alert-BNunMx_-.js";import"./Modal-CsKgPfCY.js";import"./ThemeProvider-BovkV_tw.js";import"./listen-DOhMskc_.js";import"./useWindow-BRfE8g8U.js";import"./useEventCallback-BAoW58St.js";import"./useMergedRefs-CC2NoeT3.js";import"./useWillUnmount-B2faAFH4.js";import"./TransitionWrapper-hzIxZzZF.js";import"./Transition-yovTjeQN.js";import"./TransitionGroupContext-QmIPOmoK.js";import"./useMounted-_Ax2eNue.js";import"./usePrevious-DSHR52O9.js";import"./DataKey-COGXBUcQ.js";import"./ImperativeTransition-r3w4KPGy.js";import"./useIsomorphicEffect-Dy1EPX0O.js";import"./NoopTransition-DCT8I71y.js";import"./removeClass-loOrDRrx.js";import"./hasClass-D5ZjVvBY.js";import"./Fade-C3nPY4By.js";import"./CloseButton-BaMgJgcS.js";import"./index-tz1zYP65.js";import"./divWithClassName-BYsY4_Vt.js";import"./ElementChildren-DV238mrs.js";import"./hook-BunR6YGu.js";import"./Anchor-BcSSV2GN.js";import"./Button-wtvkehlk.js";function nt($){var Y,q;const[B,Na]=s.useState($.location.state),[W,X]=s.useState(!1),[aa,M]=s.useState(!1),[ta,T]=s.useState(!1),[ea,y]=s.useState(!1),E=new Date,sa=`${E.getDate()}/${E.getMonth()+1}/${E.getFullYear()}`,[F,U]=s.useState(sa),[p,oa]=s.useState([]),[_,na]=s.useState(null),[g,A]=s.useState(14),[b,I]=s.useState(154),[i,P]=s.useState(0),[n,N]=s.useState(l.minMarkup),[r,v]=s.useState(l.standardMarkup),[m,R]=s.useState(0),[L,w]=s.useState(0),[j,D]=s.useState(0),[ra,da]=s.useState("AUD"),[ca,la]=s.useState("NPR"),[ia,ma]=s.useState("Australia"),[ha,ua]=s.useState("Nepal"),k=ya(),H=async()=>{const e={from:ra,to:ca};await u.post(`${l.BASE_URL}/getexchangeratebycurrency`,e).then(t=>{var d,c,C,f;P(Number((c=(d=t.data.result[Object.keys(t.data.result)])==null?void 0:d.toString())==null?void 0:c.match(/^\d+(?:\.\d{0,4})?/))),xa(Number((f=(C=t.data.result[Object.keys(t.data.result)])==null?void 0:C.toString())==null?void 0:f.match(/^\d+(?:\.\d{0,4})?/)))}).catch(t=>{console.log(t,"err")})},xa=async e=>{await u.get(`${l.BASE_URL}/getlastexchangerate`).then(t=>{var d,c,C,f,z,J;R(Number((c=(d=t.data.data)==null?void 0:d.toString())==null?void 0:c.match(/^\d+(?:\.\d{0,4})?/))),w(t.data.data-n<e-r?Number((C=(e-r).toString())==null?void 0:C.match(/^\d+(?:\.\d{0,4})?/)):Number((f=(t.data.data-n).toString())==null?void 0:f.match(/^\d+(?:\.\d{0,4})?/))),D(t.data.data-n<e-r?Number((z=(e-r).toString())==null?void 0:z.match(/^\d+(?:\.\d{0,4})?/)):Number((J=(t.data.data-n).toString())==null?void 0:J.match(/^\d+(?:\.\d{0,4})?/)))}).catch(t=>{console.log(t,"err")})},pa=()=>{const e={fromCountryId:g,toCountryId:b};u.post(`${l.BASE_URL}/getexchangeratebycountryid`,e).then(t=>{v(t.data.data.standardMarkup),N(t.data.data.minimumMarkup)})},ga=async()=>{},O=async()=>{var t,d;const e={fromCountryId:g,toCountryId:b,validFrom:F,minimumMarkup:n,standardMarkup:r,dealRate:m,liveRate:i,publishedRate:m-n<i-r?Number((t=(m-n).toString())==null?void 0:t.match(/^\d+(?:\.\d{0,4})?/)):Number((d=(i-r).toString())==null?void 0:d.match(/^\d+(?:\.\d{0,4})?/)),customPublishedRate:j,isConstant:!1};await u.post(`${l.BASE_URL}/saveexchangerate`,e).then(c=>{c.data.statuscode==200&&(w(!1),k("/exchange-rate"))}).catch(c=>{console.log("err",c)})},ba=()=>{T(!1)},ja=()=>{y(!1),D(L)},Sa=()=>{j!==L?_===!0?T(!0):y(!0):O()},Z=async()=>{if(j!==L){const e={id:B,fromCountryId:g,toCountryId:b,validFrom:F,minimumMarkup:n,standardMarkup:r,dealRate:m,liveRate:i,publishedRate:j,isConstant:!0};await u.post(`${l.BASE_URL}/updateexchangerate`,e).then(t=>{t.data.statuscode==200&&M(!0),A(t.data.data.fromCountryId),I(t.data.data.toCountryId),U(t.data.data.validFrom),N(t.data.data.minimumMarkup),v(t.data.data.standardMarkup),R(t.data.data.dealRate),P(t.data.data.liveRate),w(t.data.data.publishedRate),y(!1),k("/exchange-rate")}).catch(t=>{console.log("err",t)})}else{const e={id:B,fromCountryId:g,toCountryId:b,validFrom:F,minimumMarkup:n,standardMarkup:r,dealRate:m,liveRate:i,publishedRate:j,isConstant:!1};await u.post(`${l.BASE_URL}/updateexchangerate`,e).then(t=>{t.data.statuscode==200&&M(!0),A(t.data.data.fromCountryId),I(t.data.data.toCountryId),U(t.data.data.validFrom),N(t.data.data.minimumMarkup),v(t.data.data.standardMarkup),R(t.data.data.dealRate),P(t.data.data.liveRate),w(t.data.data.publishedRate),y(!1),k("/exchange-rate")}).catch(t=>{console.log("err",t)})}},Ca=async e=>{A(e.target.value);const t=p.filter(d=>d.id==e.target.value);da(t[0].currency),ma(t[0].name)},fa=async e=>{I(e.target.value);const t=p.filter(d=>d.id==e.target.value);la(t[0].currency),ua(t[0].name)},G=()=>{k("/exchange-rate")};return s.useEffect(()=>{u.get(`${l.BASE_URL}/getallcountries`).then(e=>{oa(e.data.data)}).catch(e=>{console.log(e)}),na($.location.state),H(),ga(),pa()},[g,b,ia,ha,n,r]),a.jsx(a.Fragment,{children:a.jsx("section",{onClick:()=>{document.body.classList.remove("offcanvas-active")},children:a.jsx(S,{children:a.jsx("div",{className:"mainBoxService mt-5",children:a.jsxs("div",{className:"serviceHeader bg-white text-black rounded-0",children:[a.jsx("h3",{className:"text-black px-4 mx-2 responsiveFontLargeHeading normal  border-bottom  pt-4 pb-3 pb-2",children:"Exchange Rate New"}),a.jsx("div",{className:"mainBoxService-Body bg-white text-black pe-4 ps-4 py-4",children:a.jsxs(o,{children:[a.jsxs(S,{className:"",children:[a.jsxs(x,{className:"mb-4 respoChildFooter",children:[a.jsxs(o.Group,{as:h,controlId:"formGridState",children:[a.jsx(o.Label,{children:"Exchange From"}),a.jsx(o.Select,{onChange:e=>{Ca(e)},value:g,children:p==null?void 0:p.map(e=>a.jsx("option",{value:e==null?void 0:e.id,children:e==null?void 0:e.name}))})]}),a.jsxs(o.Group,{as:h,controlId:"formGridState",className:"pbDowSt",children:[a.jsx(o.Label,{children:"Exchange To"}),a.jsx(o.Select,{onChange:e=>{fa(e)},value:b,children:p.map(e=>a.jsx("option",{value:e.id,children:e.name}))})]}),a.jsx(S,{className:"pt-4",children:a.jsx(x,{children:a.jsx(h,{className:"col-lg-12",children:a.jsx("div",{className:"text-white",children:a.jsxs(V,{variant:"success",children:["Show Live Rate : ",i]},"success")})})})})]}),a.jsxs(x,{className:"mb-4 respoChildFooter",children:[a.jsxs(o.Group,{as:h,controlId:"formGridCity",children:[a.jsx(o.Label,{children:"Standard Markup"}),a.jsx(o.Control,{value:r,type:"number",onChange:e=>v(e.target.value)})]}),a.jsxs(o.Group,{as:h,controlId:"formGridZip",className:"pbDowSt",children:[a.jsx(o.Label,{children:"Minimum Markup"}),a.jsx(o.Control,{value:n,type:"number",onChange:e=>N(e.target.value)})]})]}),a.jsxs(x,{className:"mb-4 respoChildFooter",children:[a.jsxs(o.Group,{as:h,controlId:"formGridZip",className:"",children:[a.jsx(o.Label,{children:"Our Deal Rate"}),a.jsx(o.Control,{value:m,type:"number",onChange:e=>R(e.target.value)})]}),a.jsxs(o.Group,{as:h,controlId:"formGridPR",className:"pbDowSt",children:[a.jsx(o.Label,{children:"Custom Publish Rate"}),a.jsx(o.Control,{value:j,type:"number",onChange:e=>D(e.target.value)})]})]})]}),a.jsx(S,{className:"",children:a.jsx(x,{children:a.jsxs(h,{className:"col-lg-12 d-flex justify-content-end respoChildFooter",children:[a.jsx("div",{className:"d-none col-lg-6 mx-1",children:a.jsx("div",{style:{background:"#AA2AE1",width:"100%"},className:"pt-3 pb-3 rounded btn text-white",onClick:()=>H(),children:"Show Publish Rate"})}),a.jsx("div",{className:"col-lg-6 mx-1",children:a.jsx("div",{className:"text-white pbDowSt",children:a.jsxs(V,{className:"rounded text-center",variant:"primary",children:["Publish Rate : ",m-n<i-r?Number((Y=(m-n).toString())==null?void 0:Y.match(/^\d+(?:\.\d{0,4})?/)):Number((q=(i-r).toString())==null?void 0:q.match(/^\d+(?:\.\d{0,4})?/))]},"success")})})]})})}),a.jsx("div",{className:"d-flex",children:_===!0?a.jsx(S,{className:"pt-3",children:a.jsx(x,{children:a.jsxs("div",{className:"d-flex",children:[a.jsx("div",{className:"",children:a.jsx("a",{style:{background:"#AA2AE1"},onClick:()=>Sa(),className:"rounded btn text-white",children:"Create"})}),a.jsx("div",{className:"",children:a.jsx("div",{className:" border-0",children:a.jsx("a",{onClick:()=>G(),className:"btn btn-default ms-3 text-black bolder border 2",children:"Cancel"})})})]})})}):a.jsx(S,{className:"pt-3",children:a.jsx(x,{children:a.jsxs("div",{className:"d-flex",children:[a.jsx("div",{children:a.jsx("div",{style:{background:"#AA2AE1"},onClick:()=>{Z()},className:"rounded btn text-white",children:"Edit"})}),a.jsx("div",{className:"",children:a.jsx("div",{className:"border-0",children:a.jsx("a",{onClick:()=>G(),className:"btn btn-default ms-3 text-black bolder border 2",children:"Cancel"})})})]})})})}),a.jsx(K,{show:aa,title11:"Exchange Rate updated successfully",onHide:()=>M(!1)}),a.jsx(K,{show:W,title11:"Exchange Rate added successfully",onHide:()=>{X(!1),G()}}),a.jsx(Q,{show:ta,title1:"Are you sure want to change this Publish Rate ?",cancle:e=>ba(),SavePr:()=>O()}),a.jsx(Q,{show:ea,title1:"Are you sure want to change this Publish Rate ?",cancle:e=>ja(),SavePr:()=>Z()})]})})]})})})})})}export{nt as default};
