import{c as L,o as S}from"./listen-DOhMskc_.js";import{r as s,j as m}from"./index-CZLZpOaH.js";import{u as W}from"./useWindow-BRfE8g8U.js";import{u as j}from"./useMergedRefs-CC2NoeT3.js";import{u as D}from"./useEventCallback-BAoW58St.js";import{u as b}from"./useIsomorphicEffect-Dy1EPX0O.js";import{N as I}from"./NoopTransition-DCT8I71y.js";const h=(n,i)=>L?n==null?(i||S()).body:(typeof n=="function"&&(n=n()),n&&"current"in n&&(n=n.current),n&&("nodeType"in n||n.getBoundingClientRect)?n:null):null;function Q(n,i){const e=W(),[r,o]=s.useState(()=>h(n,e==null?void 0:e.document));if(!r){const t=h(n);t&&o(t)}return s.useEffect(()=>{},[i,r]),s.useEffect(()=>{const t=h(n);t!==r&&o(t)},[n,r]),r}function X(n){return n.code==="Escape"||n.keyCode===27}function K(){const n=s.version.split(".");return{major:+n[0],minor:+n[1],patch:+n[2]}}const M=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function F(n,i){if(n==null)return{};var e={},r=Object.keys(n),o,t;for(t=0;t<r.length;t++)o=r[t],!(i.indexOf(o)>=0)&&(e[o]=n[o]);return e}function G(n){let{onEnter:i,onEntering:e,onEntered:r,onExit:o,onExiting:t,onExited:a,addEndListener:f,children:c}=n,u=F(n,M);const{major:x}=K(),g=x>=19?c.props.ref:c.ref,d=s.useRef(null),p=j(d,typeof c=="function"?null:g),l=E=>R=>{E&&d.current&&E(d.current,R)},v=s.useCallback(l(i),[i]),y=s.useCallback(l(e),[e]),k=s.useCallback(l(r),[r]),C=s.useCallback(l(o),[o]),O=s.useCallback(l(t),[t]),T=s.useCallback(l(a),[a]),w=s.useCallback(l(f),[f]);return Object.assign({},u,{nodeRef:d},i&&{onEnter:v},e&&{onEntering:y},r&&{onEntered:k},o&&{onExit:C},t&&{onExiting:O},a&&{onExited:T},f&&{addEndListener:w},{children:typeof c=="function"?(E,R)=>c(E,Object.assign({},R,{ref:p})):s.cloneElement(c,{ref:p})})}const N=["component"];function _(n,i){if(n==null)return{};var e={},r=Object.keys(n),o,t;for(t=0;t<r.length;t++)o=r[t],!(i.indexOf(o)>=0)&&(e[o]=n[o]);return e}const $=s.forwardRef((n,i)=>{let{component:e}=n,r=_(n,N);const o=G(r);return m.jsx(e,Object.assign({ref:i},o))});function z({in:n,onTransition:i}){const e=s.useRef(null),r=s.useRef(!0),o=D(i);return b(()=>{if(!e.current)return;let t=!1;return o({in:n,element:e.current,initial:r.current,isStale:()=>t}),()=>{t=!0}},[n,o]),b(()=>(r.current=!1,()=>{r.current=!0}),[]),e}function A({children:n,in:i,onExited:e,onEntered:r,transition:o}){const[t,a]=s.useState(!i);i&&t&&a(!1);const f=z({in:!!i,onTransition:u=>{const x=()=>{u.isStale()||(u.in?r==null||r(u.element,u.initial):(a(!0),e==null||e(u.element)))};Promise.resolve(o(u)).then(x,g=>{throw u.in||a(!0),g})}}),c=j(f,n.ref);return t&&!i?null:s.cloneElement(n,{ref:c})}function Y(n,i,e){return n?m.jsx($,Object.assign({},e,{component:n})):i?m.jsx(A,Object.assign({},e,{transition:i})):m.jsx(I,Object.assign({},e))}export{X as i,Y as r,Q as u};
